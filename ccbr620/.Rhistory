targets
setwd("/Users/maggiec/GitHub/Maggie/ccbr620/")
load("data/RNASeq_orig.RData")
mapped=read.delim(file = "data/mapped.txt",header = TRUE)
targets$mapped=mapped$mapped
targets
targets$Phenotype[c(7,8,10)] <- "fgf20lz/lz mutant"
targets$Phenotype[c(9,11,12)] <- "fgf20lz/+ control"
targets
vdf=vdf[,c(1,2,3,4,5,6,9,11,12,7,8,10)]
w2$E=v2$E[,c(3,5,6,1,2,4)]
targets[7:12,]
celltype <- factor(targets$Phenotype[7:12])
design2 <- model.matrix(~celltype)
design2
v2 <- voom(x[,7:12],design2,plot=TRUE,normalize="quantile")
library(edgeR)
v2 <- voom(x[,7:12],design2,plot=TRUE,normalize="quantile")
x <- DGEList(counts=fc$counts, genes=fc$annotation)
isexpr <- rowSums(cpm(x)>0.5) >= 2
hasannot <- rowSums(is.na(x$genes))==0
x <- x[isexpr & hasannot,keep.lib.sizes=FALSE]
dim(x)
x <- calcNormFactors(x)
design2 <- model.matrix(~celltype)
fit2 <- lmFit(v2,design2)
targets[7:12,]
celltype <- factor(targets$Phenotype[7:12])
design2 <- model.matrix(~celltype)
design2
v2 <- voom(x[,7:12],design2,plot=TRUE,normalize="quantile")
w2=v2
w2$E=v2$E[,c(1,2,4,3,5,6)]
design2 <- model.matrix(~celltype)
fit2 <- lmFit(v2,design2)
fit2 <- eBayes(fit2)
options(digits=3)
topgenes2=topTable(fit2,coef=2,n=50,sort.by="p")
finalres2=topTable(fit2,coef=2,sort="none",n=Inf)
FC2 = 2^(fit2$coefficients[,2])
FC2 = ifelse(FC2<1,-1/FC2,FC2)
w2=v2
w2$E=v2$E[,c(1,2,4,3,5,6)]
topgenes_data2=w2$E[rownames(w2$E) %in% rownames(topgenes2),]
topgenes_data2=topgenes_data2[match(rownames(topgenes2),rownames(topgenes_data2)),]
colnames(topgenes_data2)=targets$Phenotype[match(colnames(topgenes_data2),targets$bam)]
colnames(topgenes_data2)= sapply(strsplit(colnames(topgenes_data2),split=" "),function(x) x[1])
colnames(topgenes_data2)=paste(colnames(topgenes_data2),targets$Batch[7:12])
d3heatmap(topgenes_data2, scale = "row", dendrogram = "none", main = "title",
color = "YlOrRd",cexRow=1,main="topgenes")
library(d3heatmap)
d3heatmap(topgenes_data2, scale = "row", dendrogram = "none", main = "title",
color = "YlOrRd",cexRow=1,main="topgenes")
head(topgenes_data2)
finalres2 = cbind(v2$E,FC2,finalres2)
head(finalres2)
fit2
?lmFit
topTableF(fit2)
plotlines(fit2)
fit2$Amean
head(fit2$Amean)
v$E[1,1]
v2$E[1,1]
v2$E[1,]
v2$E[1,1]
v2$E[1,]
v2
head(v2$E)
targets
v2$E[,match(colnames(v2$E),rownames(targets$bam))]
v2$E[,match(colnames(v2$E),rownames(targets$bam[7:12]))]
rownames(targets$bam[7:12]
)
v2$E[,match(colnames(v2$E),names(targets$bam[7:12]))]
targets
targets$bam[7:12]
colnames(v2$E)
targets$Phenotype[match(colnames(v2$E),targets$bam[7:12])]
targets$Phenotype[match(targets$bam[7:12],colnames(v2$E))]
